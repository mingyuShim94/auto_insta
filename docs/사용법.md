# Instagram 게시물 텍스트 추출기 사용법

## 📚 목차
1. [기본 사용법](#기본-사용법)
2. [명령줄 옵션](#명령줄-옵션)
3. [사용 예시](#사용-예시)
4. [배치 처리](#배치-처리) ⭐ **NEW**
5. [대화형 모드](#대화형-모드)
6. [파일 저장](#파일-저장)
7. [에러 상황 대처](#에러-상황-대처)
8. [팁과 주의사항](#팁과-주의사항)

## 기본 사용법

### 환경 설정
프로그램을 실행하기 전에 가상환경이 활성화되어 있는지 확인하세요:

```bash
# 가상환경 활성화 (이미 설치되어 있음)
source .venv/bin/activate

# 또는 직접 Python 경로 사용
./.venv/bin/python
```

### 기본 실행 명령어

```bash
# 기본 형태
PYTHONPATH=. ./.venv/bin/python -m src [Instagram_URL] [옵션들]

# 간단한 텍스트 추출 (본문만)
PYTHONPATH=. ./.venv/bin/python -m src https://www.instagram.com/p/DOiSOJwEvAT/

# 메타데이터 포함하여 출력
PYTHONPATH=. ./.venv/bin/python -m src https://www.instagram.com/p/DOiSOJwEvAT/ --metadata
```

## 명령줄 옵션

| 옵션 | 단축형 | 설명 | 예시 |
|------|--------|------|------|
| `--metadata` | `-m` | 작성자, 좋아요 수, 날짜 등 메타데이터 표시 | `--metadata` |
| `--save FORMAT` | `-s` | 결과를 파일로 저장 (`txt` 또는 `json`) | `--save txt` |
| `--output FILENAME` | `-o` | 저장할 파일명 지정 (확장자 제외) | `--output my_post` |
| `--quiet` | `-q` | 최소한의 출력만 표시 (본문만) | `--quiet` |
| `--batch-file PATH` | `-b` | URL 목록 파일로 배치 처리 ⭐ **NEW** | `--batch-file urls.txt` |
| `--combined-output` | `-c` | 모든 결과를 하나의 통합 파일로 저장 ⭐ **NEW** | `--combined-output` |
| `--delay SECONDS` | `-d` | URL 처리 간 대기시간 (기본 3초) ⭐ **NEW** | `--delay 5` |
| `--help` | `-h` | 도움말 표시 | `--help` |

## 사용 예시

### 1. 기본 텍스트 추출

```bash
PYTHONPATH=. ./.venv/bin/python -m src https://www.instagram.com/p/DOiSOJwEvAT/
```

**출력:**
```
📥 게시물 정보를 가져오는 중...

============================================================
📱 Instagram 게시물 본문
============================================================
💬 본문:
예쁜 아이들. 🥰 진짜 이 일을 하면서 계속 준비했던 이야기 역사특강...
============================================================
```

### 2. 메타데이터 포함 출력

```bash
PYTHONPATH=. ./.venv/bin/python -m src https://www.instagram.com/p/DOiSOJwEvAT/ --metadata
```

**출력:**
```
============================================================
📱 Instagram 게시물 본문
============================================================
👤 작성자: @theallmy
❤️ 좋아요: 14개
📅 게시일: 2025년 09월 13일 08:27
📎 미디어: 📸 이미지
------------------------------------------------------------
💬 본문:
예쁜 아이들. 🥰 진짜 이 일을 하면서 계속 준비했던 이야기...
============================================================
```

### 3. 간단 출력 모드 (본문만)

```bash
PYTHONPATH=. ./.venv/bin/python -m src https://www.instagram.com/p/DOiSOJwEvAT/ --quiet
```

**출력:**
```
예쁜 아이들. 🥰 진짜 이 일을 하면서 계속 준비했던 이야기 역사특강...
```

### 4. 텍스트 파일로 저장

```bash
PYTHONPATH=. ./.venv/bin/python -m src https://www.instagram.com/p/DOiSOJwEvAT/ --save txt --output my_post
```

결과가 `outputs/my_post.txt` 파일로 저장됩니다.

### 5. JSON 파일로 저장

```bash
PYTHONPATH=. ./.venv/bin/python -m src https://www.instagram.com/p/DOiSOJwEvAT/ --save json --output data
```

결과가 `outputs/data.json` 파일로 저장되며, 구조화된 데이터 형태로 저장됩니다:

```json
{
  "text": "예쁜 아이들. 🥰 진짜 이 일을 하면서...",
  "username": "theallmy",
  "likes": 14,
  "date": "2025-09-13T08:27:00",
  "media_count": 1,
  "is_video": false,
  "url": "https://www.instagram.com/p/DOiSOJwEvAT/"
}
```

### 6. 모든 옵션 조합

```bash
PYTHONPATH=. ./.venv/bin/python -m src https://www.instagram.com/p/DOiSOJwEvAT/ --metadata --save json --output detailed_post
```

메타데이터가 포함된 출력을 화면에 표시하고, 동시에 JSON 파일로 저장합니다.

## 대화형 모드

URL을 지정하지 않으면 대화형 모드로 실행됩니다:

```bash
PYTHONPATH=. ./.venv/bin/python -m src
```

**대화형 모드 흐름:**

```
🎯 Instagram 게시물 텍스트 추출기
----------------------------------------
Instagram 게시물 링크를 입력하세요.
(종료하려면 'quit' 또는 'exit' 입력)

📱 Instagram URL: https://www.instagram.com/p/DOiSOJwEvAT/

📥 게시물 정보를 가져오는 중...
[결과 출력]

📁 결과를 파일로 저장하시겠습니까? (y/n): y
파일 형식을 선택하세요:
1. 텍스트 파일 (.txt)
2. JSON 파일 (.json)
선택 (1-2): 1

✅ 결과를 outputs/instagram_theallmy_20250914_123456.txt에 저장했습니다.

🔄 다른 게시물을 처리하시겠습니까? (y/n): n
👋 프로그램을 종료합니다.
```

## 배치 처리 ⭐ **NEW**

여러 Instagram URL을 한 번에 처리할 수 있는 배치 기능을 제공합니다.

### URL 목록 파일 준비

먼저 처리할 URL들을 텍스트 파일로 준비합니다:

```bash
# urls.txt 파일 생성
cat > urls.txt << EOF
https://www.instagram.com/p/DOgZA3hEjQ5/
https://www.instagram.com/p/DOiSOJwEvAT/
https://www.instagram.com/p/DN3NOXpZENJ/
https://www.instagram.com/p/DOSS3O8kh5I/
EOF
```

### 배치 처리 실행

#### 기본 배치 처리
```bash
PYTHONPATH=. ./.venv/bin/python -m src --batch-file urls.txt --metadata
```

#### 통합 결과 파일로 저장 (TXT 형식)
```bash
PYTHONPATH=. ./.venv/bin/python -m src --batch-file urls.txt --metadata --save txt --combined-output
```

#### 통합 결과 파일로 저장 (JSON 형식)
```bash
PYTHONPATH=. ./.venv/bin/python -m src --batch-file urls.txt --metadata --save json --combined-output
```

#### 처리 간격 조정 (5초 대기)
```bash
PYTHONPATH=. ./.venv/bin/python -m src --batch-file urls.txt --metadata --save txt --combined-output --delay 5
```

### 배치 처리 결과

#### 개별 파일 저장
각 URL에 대해 개별 파일이 생성됩니다:
```
outputs/
├── instagram_theallmy_20250915_123456.txt
├── instagram_theallmy_20250915_123501.txt
├── instagram_wealbuza_20250915_123506.txt
└── ...
```

#### 통합 파일 저장
모든 결과가 하나의 파일로 저장됩니다:

**TXT 형식 예시:**
```
================================================================================
📱 Instagram 배치 처리 결과
📅 처리일시: 2025년 09월 15일 00:13:47
📊 총 처리 건수: 4개
================================================================================

[01] https://www.instagram.com/p/DOgZA3hEjQ5/
👤 작성자: @theallmy
❤️ 좋아요: 10개
📅 게시일: 2025년 09월 12일 14:48

💬 본문:
벼락치기 내일은 역사특강 storytelling...

------------------------------------------------------------

[02] https://www.instagram.com/p/DOiSOJwEvAT/
...
```

**JSON 형식 예시:**
```json
{
  "processed_at": "2025-09-15T00:12:38.386876",
  "total_count": 4,
  "results": [
    {
      "text": "벼락치기 내일은 역사특강...",
      "username": "theallmy",
      "likes": 10,
      "date": "2025-09-12T14:48:29",
      "media_count": 1,
      "is_video": false,
      "url": "https://www.instagram.com/p/DOgZA3hEjQ5/"
    }
  ]
}
```

### 배치 처리 옵션

| 옵션 | 설명 | 기본값 |
|------|------|--------|
| `--batch-file` | URL 목록이 담긴 파일 경로 | - |
| `--combined-output` | 모든 결과를 하나의 파일로 저장 | false |
| `--delay` | URL 처리 간 대기시간 (초) | 3초 |

### 배치 처리 주의사항

1. **Rate Limiting 방지**: 기본 3초 대기, 필요시 `--delay` 옵션으로 조정
2. **파일 형식**: URL 목록 파일은 한 줄당 하나의 URL
3. **주석 지원**: `#`으로 시작하는 줄은 주석으로 처리
4. **에러 처리**: 개별 URL 처리 실패 시에도 나머지 URL 계속 처리
5. **진행상황**: 실시간으로 처리 진행상황 표시

### URL 목록 파일 형식

```bash
# Instagram URL 목록 파일
# 테스트용 URL들
https://www.instagram.com/p/DOgZA3hEjQ5/
https://www.instagram.com/p/DOiSOJwEvAT/

# 비공개 계정 URL (처리 건너뜀)
# https://www.instagram.com/p/PRIVATE_POST/

https://www.instagram.com/p/DN3NOXpZENJ/
```

## 파일 저장

### 자동 파일명 생성
파일명을 지정하지 않으면 다음 형식으로 자동 생성됩니다:
```
instagram_{작성자명}_{날짜시간}.{확장자}

예: instagram_theallmy_20250914_123456.txt
```

### 저장 위치
모든 파일은 `outputs/` 디렉토리에 저장됩니다. 디렉토리가 없으면 자동으로 생성됩니다.

### 지원 형식
- **TXT**: 사람이 읽기 쉬운 형태로 포맷팅
- **JSON**: 구조화된 데이터 형태 (프로그래밍 용도)

## 에러 상황 대처

### 🔗 URL 관련 오류
```
🔗 오류 발생:
   유효하지 않은 Instagram URL입니다.
```
**해결방법**: Instagram 게시물 URL 형식을 확인하세요.
- 올바른 형식: `https://www.instagram.com/p/ABC123/`
- 지원 경로: `/p/`, `/reel/`, `/tv/`

### 🔒 권한 관련 오류
```
🔒 오류 발생:
   비공개 계정입니다. 로그인이 필요합니다.
```
**해결방법**: 현재 버전은 공개 게시물만 지원합니다. 비공개 계정의 게시물은 추출할 수 없습니다.

### 🌐 네트워크 관련 오류
```
🌐 오류 발생:
   네트워크 연결 오류: ...
```
**해결방법**:
1. 인터넷 연결 상태 확인
2. 잠시 후 다시 시도
3. VPN 사용 시 연결 해제 후 시도

### ❌ 게시물 없음
```
🔗 오류 발생:
   게시물이 삭제되었거나 존재하지 않습니다.
```
**해결방법**: URL을 다시 확인하거나 다른 게시물로 시도해보세요.

## 팁과 주의사항

### ✅ 사용 팁
1. **URL 복사**: Instagram 앱에서 '링크 복사'를 사용하세요
2. **배치 처리**: 여러 URL을 처리할 때는 대화형 모드를 활용하세요
3. **파일 정리**: `outputs/` 디렉토리를 정기적으로 정리하세요
4. **인코딩**: 한글과 이모지가 포함된 텍스트도 완벽하게 처리됩니다

### ⚠️ 주의사항
1. **공개 게시물만**: 비공개 계정이나 로그인이 필요한 게시물은 처리할 수 없습니다
2. **Rate Limiting**: 단시간에 너무 많은 요청을 보내면 일시적으로 차단될 수 있습니다
3. **지원 URL**: `/p/`, `/reel/`, `/tv/` 경로의 게시물만 지원합니다
4. **저작권**: 추출한 텍스트는 개인적 용도로만 사용하세요

### 🔧 문제 해결

**프로그램이 실행되지 않을 때:**
```bash
# Python 경로 확인
which python
ls -la .venv/bin/python

# 의존성 재설치
pip install -r requirements.txt
```

**권한 오류가 발생할 때:**
```bash
# 파일 실행 권한 확인
chmod +x .venv/bin/python
```

**모듈을 찾을 수 없을 때:**
```bash
# PYTHONPATH 환경변수 확인
echo $PYTHONPATH
# 반드시 PYTHONPATH=. 을 포함해서 실행
```

## 📞 도움말

더 자세한 옵션을 확인하려면:
```bash
PYTHONPATH=. ./.venv/bin/python -m src --help
```

문제가 지속되면 README.md 파일을 참고하거나 이슈를 등록해 주세요.